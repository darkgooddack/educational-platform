# Циклические импорты

В Python есть такая штука как циклические импорты, и иногда единственный способ их победить - это перенести импорт внутрь функции.

Это не костыль, а вполне себе легитимный паттерн. Даже в стандартной библиотеке Python такое встречается.

Когда у тебя большое приложение с кучей взаимозависимых модулей (как у нас тут), иногда просто невозможно разложить все импорты красиво сверху. Питон не может загрузить модуль А, который импортирует модуль B, который в свою очередь импортирует модуль А.

Так что да - импорты сверху это хорошо, но иногда приходится делать импорт там, где он реально нужен. Это нормально и даже рекомендуется в таких случаях.

## Триггер (куда смотреть, чтобы понять)
О, тут есть четкий триггер! Смотри на путь импорта:

Если модуль А импортирует модуль B
А модуль B импортирует что-то из модуля A
Вот тебе и циклическая зависимость. 
Особенно внимательно смотри на:

- конфиги
- зависимости (dependencies)
- сервисы
- middleware
- storage/repository классы

Эти компоненты часто ссылаются друг на друга.

Простой чек-лист:

1. Увидел ImportError с текстом "circular import" - ищи кольцо в импортах
2. Нашел импорт, который создает кольцо - переноси его внутрь функции/метода
3. Оставляй наверху только те импорты, которые не создают циклов

Базовое правило: если класс/функция А использует класс B, а B использует A - один из импортов должен быть локальным.